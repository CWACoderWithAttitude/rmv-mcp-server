= RMV MCP Server

== TL;DR

MCP Server to enable LLMs to use data on trains, stations and connections provided by RMV, Germany.

== What are MCP servers?
MCP servers enable you to ask questions on YOUR data (in DBs, APIs, fielsystems,...) with natural language.
https://www.anthropic.com/news/model-context-protocol[Anthropics (the inventors) full blown explanation] on MCPs.

== What's this project about?

The aim is to give you a brief introduction into MCP servers. 

To show the usefullness i chose to use the API provided by RMV - the Frankfurt Rhein-Main Verkehrsverbund - which operates public transport in the Frankfurt Rhein-Main area.

With this MCP server you can query stations, connections and departures from an LLM like Claude.
We'll use the https://gofastmcp.com/getting-started/welcome[FastMCP] framework to build the MCP server .

== Prerequisites

This example uses `python3.13` and `UV 0.8.13` to run the MCP server.

To access station and connection data, you need to acquire an API key. 
It can be requested free of charge from RMV at the https://opendata.rmv.de/site/start.html[RMV Open Data Portal].

> For local testing Copy `DOTEnv` to `.env` and add the API key there.

=== Running MCP Server in Dev Mode

FastMCP provides a development mode that allows you to run and test your MCP server locally.

Start the server in dev mode:

[source,bash]
----
uv run fastmcp dev main.py 
---- 

This will start the MCP server and open the MCP Inspector in your browser, allowing you to inspect and debug your MCP server.
It will open the MCP Inspector in your browser, allowing you to inspect and debug your MCP server.

1. Connect to your MCP sever (left column)
2. Select `Tools` from the top menu.
3. Click `List Tools` below.
    It should reveal `search_stations` and `get_connections`.
   Select one of them.
4. The right hand side enables you to run the tool and inspect the results.

How cool is that!   

=== Claude Desktop Config

I'll show you how to run the RMV MCP server locally using UV and how to connect it to Claude Desktop.
To make the service known to Claude Desktop you need to add its configuration to the Claude Desktop config file (see below).

Once you have it, you can enter it in Claude's config file.

[source,json]
```
{
    "mcpServers": {

	"rmv-mcp-server": {
          "command": "/Users/volker/.local/bin/uv",
          "args": [
		  "--directory", 
		  "/Users/volker/Dev/mcp/fast_mcp/rmv-mcp-server",
		  "run",
		  "rmv_stdio.py"
	        ],
          "env": {
            "RMV_API_KEY": "<YOUR_API_KEY>"
          }
    	}
    }
}


== Overview 

RMV MCP Server is a fastmcp-based MCP server that exposes RMV public transport data to LLMs. It uses the RMV API to fetch data on stations, connections, and departures.

=== Architecture Diagram
[source,mermaid]
....

graph TD
    subgraph RMV_MCP_Server
        A[rmv_stdio.py] --> B[RMVService]
        B[RMVService] --> C[RMV API]
    end

    subgraph Tests
        D[test_rmv_stdio.py] --> A[rmv_stdio.py]
        D[test_rmv_stdio.py] --> E[fastmcp.client.Client]
    end

    subgraph External_Services
        C[RMV API]
    end

    subgraph FastMCP_Framework
        A[rmv_stdio.py] --> F[FastMCP]
        E[fastmcp.client.Client] --> F[FastMCP]
    end
....


== How to use

I'll show you how to run the RMV MCP server locally using UV and how to connect it to Claude Desktop.
To make the service known to Claude Desktop you need to add its configuration to the Claude Desktop config file (see below).

=== Claude Desktop Config
[source,json]
```
{
    "mcpServers": {

	"rmv-mcp-server": {
          "command": "/Users/volker/.local/bin/uv",
          "args": [
		  "--directory", 
		  "/Users/volker/Dev/mcp/fast_mcp/rmv-mcp-server",
		  "run",
		  "rmv_stdio.py"
	        ],
          "env": {
            "RMV_API_KEY": "<YOUR_API_KEY>"
          }
    	}
    }
}

```

=== Dev

> I like Makefiles. I use them as part of my documentation. You can find some of the mentioned commands in the provided `Makefile`.

==== Run Tests

[source,bash]
```
uv run pytest -s
```




## Links
* [Installing UV](https://docs.astral.sh/uv/guides/integration/docker/#installing-uv)
* [Claude Custom connectors](https://support.claude.com/en/articles/11175166-getting-started-with-custom-connectors-using-remote-mcp)
* Diagram generate with https://marketplace.visualstudio.com/items?itemName=swark.swark[Swark Mermaid Extension]